<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    <title>Document recognition with Python, OpenCV and Tesseract</title>
    <meta name="description" content="" />

    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="shortcut icon" href="https://AwesomeLemon.github.io/favicon.ico">

    <script type="text/javascript" src="//AwesomeLemon.github.io/themes/ichi/assets/js/vendor/fastclick.js?v=1484479362993"></script>
    <script type="text/javascript" src="//AwesomeLemon.github.io/themes/ichi/assets/js/vendor/modernizr.js?v=1484479362993"></script>


    <link rel="stylesheet" type="text/css" href="//AwesomeLemon.github.io/themes/ichi/assets/css/normalize.css?v=1484479362993" />
    <link rel="stylesheet" type="text/css" href="//AwesomeLemon.github.io/themes/ichi/assets/css/foundation.min.css?v=1484479362993" />
    <!--[if lte IE 8]>
        <link rel="stylesheet" type="text/css" href="//AwesomeLemon.github.io/themes/ichi/assets/css/outdatedBrowser.min.css?v=1484479362993">
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="//AwesomeLemon.github.io/themes/ichi/assets/fonts/foundation-icons/foundation-icons.css?v=1484479362993" />
    <link rel="stylesheet" type="text/css" href="//AwesomeLemon.github.io/themes/ichi/assets/css/styles.css?v=1484479362993" />
    <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Open+Sans:300,700,400|Source+Sans+Pro:300,400,600,700,900,300italic,400italic,600italic,700italic,900italic" />

    <link rel="canonical" href="https://AwesomeLemon.github.io/2017/01/15/Document-recognition-with-Python-OpenCV-and-Tesseract.html" />
    <meta name="referrer" content="origin" />
    
    <meta property="og:site_name" content="Notes on coding" />
    <meta property="og:type" content="website" />
    <meta property="og:title" content="Document recognition with Python, OpenCV and Tesseract" />
    <meta property="og:description" content="Recently I’ve conducted my own little experiment with the document recognition technology: I’ve successfully went from an image to the recognized editable text. On the way I heavily relied on the two following articles: 1) http://www.pyimagesearch.com/2014/09/01/build-kick-ass-mobile-document-scanner-just-5-minutes/ 2) http://www.danvk.org/" />
    <meta property="og:url" content="https://AwesomeLemon.github.io/2017/01/15/Document-recognition-with-Python-OpenCV-and-Tesseract.html" />
    <meta property="article:tag" content="opencv" />
    <meta property="article:tag" content=" python" />
    <meta property="article:tag" content=" tesseract" />
    <meta property="article:tag" content=" ocr" />
    <meta property="article:tag" content=" open source" />
    
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Document recognition with Python, OpenCV and Tesseract" />
    <meta name="twitter:description" content="Recently I’ve conducted my own little experiment with the document recognition technology: I’ve successfully went from an image to the recognized editable text. On the way I heavily relied on the two following articles: 1) http://www.pyimagesearch.com/2014/09/01/build-kick-ass-mobile-document-scanner-just-5-minutes/ 2) http://www.danvk.org/" />
    <meta name="twitter:url" content="https://AwesomeLemon.github.io/2017/01/15/Document-recognition-with-Python-OpenCV-and-Tesseract.html" />
    
    <script type="application/ld+json">
null
    </script>

    <meta name="generator" content="HubPress" />
    <link rel="alternate" type="application/rss+xml" title="Notes on coding" href="https://AwesomeLemon.github.io/rss/" />
</head>
<body class="post-template tag-opencv tag-python tag-tesseract tag-ocr tag-open-source">

<div id="outdated">
    <h6>Your browser is out-of-date!</h6>
    <p>Update your browser to view this website correctly. <a id="btnUpdate" href="http://outdatedbrowser.com/">Update my browser now</a></p>
</div>

<nav class="top-bar hide-for-large-up" data-topbar style="background: none">
  <ul class="title-area">
    <li class="name">

    </li>
    <li class="home"><a class="fi-home" href="https://AwesomeLemon.github.io"></a></li>
    <li class="toggle-topbar"><a href="#" id="trigger-overlay" class="fi-list"></a></li>
  </ul>

<div class="overlay overlay-scale">
    <button type="button" class="overlay-close">Close</button>
    <nav>
        <ul>
            <li><a href="https://AwesomeLemon.github.io">Home</a></li>
        </ul>
    </nav>
</div>

</nav>

<div class="row">

<div class="small-16 medium-16 large-4 columns right head-area bgimage" style="background-image: url(https://pp.vk.me/c628723/v628723459/2bfc3/FGsR1V_CMvg.jpg)">

<header class="site-head">
    <div class="vertical">
        <div class="site-head-content inner">
            <ul class="side-nav blog-menu show-for-large-up">
                <li><a class="fi-home" href="https://AwesomeLemon.github.io"></a></li>
                <li><a class="fi-torso" href="https://AwesomeLemon.github.io/about"></a></li>
                <li><a class="fi-mail" href="https://AwesomeLemon.github.io/contact"></a></li>
            </ul>
            
            <h1 class="blog-title">Notes on coding</h1>
            <hr>
            <p class="blog-description">Texts about the programming I&#x27;m doing</p>
            <div class="blog-network">
<!--                 <a href="#" class="fi-social-pinterest"></a>
                <a href="#" class="fi-social-linkedin"></a>
                <a href="#" class="fi-social-behance"></a>
                <a href="#" class="fi-social-deviant-art"></a>
                <a href="#" class="fi-social-dribbble"></a>
                <a href="#" class="fi-social-flickr"></a>
                <a href="#" class="fi-social-github"></a>
                <a href="#" class="fi-social-skype"></a>
                <a href="#" class="fi-social-snapchat"></a>
                <a href="#" class="fi-social-steam"></a>
                <a href="#" class="fi-social-xbox"></a>
                <a href="#" class="fi-social-reddit"></a> -->
                  <a href="https://github.com/AwesomeLemon" class="fi-social-github"></a>
            </div>
        </div>
    </div>
</header>

</div>


<div class="small-16 medium-16 large-12 columns main-column left">
    

<main class="content" role="main">

    <article class="post tag-opencv tag-python tag-tesseract tag-ocr tag-open-source">


            <h1 class="post-title">Document recognition with Python, OpenCV and Tesseract</h1>

            <span class="post-meta label"><time datetime="2017-01-15">15 Jan 2017</time></span>

            <section class="post-content">
                <div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Recently I’ve conducted my own little experiment with the document recognition technology: I’ve successfully went from an image to the recognized editable text.<br>
On the way I heavily relied on the two following articles:</p>
</div>
<div class="paragraph">
<p>1) <a href="http://www.pyimagesearch.com/2014/09/01/build-kick-ass-mobile-document-scanner-just-5-minutes/" class="bare">http://www.pyimagesearch.com/2014/09/01/build-kick-ass-mobile-document-scanner-just-5-minutes/</a><br>
2) <a href="http://www.danvk.org/2015/01/07/finding-blocks-of-text-in-an-image-using-python-opencv-and-numpy.html" class="bare">http://www.danvk.org/2015/01/07/finding-blocks-of-text-in-an-image-using-python-opencv-and-numpy.html</a></p>
</div>
<div class="paragraph">
<p>However, I’ve added something myself, and that’s what I want to write about: the ways to improve upon the given articles to achieve the goal of recognizing plain text from photos at arbitrary angles and illumination.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_skew_removal_first_article">Skew removal (first article)</h4>
<div class="ulist">
<ul>
<li>
<p>If the edges in your image aren’t recognized properly, it makes sense to move interval in Canny function to the left. For example, I’ve settled on [40, 150], instead of [75, 200] proposed in the article.</p>
</li>
<li>
<p>To be able to recognize documents with less straight than rectangular shapes (for example, with curved corners), you should apply blurring to the image with detected edges. I found that it improves approximation quality even in some cases of “good” document shapes, and decreases in none.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Resulting image at this point can be fed to the Tesseract engine, but to get better results out of it, we can conduct two more steps:</p>
</div>
</div>
<div class="sect3">
<h4 id="_noise_removal">Noise removal</h4>
<div class="paragraph">
<p>I’ve experimented with different combinations of Gaussian blur, median blur, erosion and dilation (these last two can sound scary, but they aren’t. See <a href="http://docs.opencv.org/2.4/doc/tutorials/imgproc/erosion_dilatation/erosion_dilatation.html" class="bare">http://docs.opencv.org/2.4/doc/tutorials/imgproc/erosion_dilatation/erosion_dilatation.html</a>).</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Gaussian blur corrupts text more than median blur</p>
</li>
<li>
<p>I found that using only dilation yields better average results than any other combination of mentioned techniques.</p>
</li>
<li>
<p>In addition to removing noise, dilation makes text clearer (by making white spaces inside of letter such as ‘a’ or ‘e’ bigger)</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_cropping_second_article">Cropping (second article)</h4>
<div class="ulist">
<ul>
<li>
<p>To achieve quicker processing, the image at this step can be resized not to the height of 2048, but of 600 (I wouldn’t recommend anything less than 500). I haven’t observed any negative effects after introducing this change.</p>
</li>
<li>
<p>Two rank filters can be replaced by a single median blur</p>
</li>
<li>
<p>Shape of the dilation kernel doesn’t affect the result</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Now it’s time to feed the resulting image to the Tesseract. It can be done quite simply with:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-python" data-lang="python">pytesseract.image_to_string(Image.open('scan_res.jpg'))</code></pre>
</div>
</div>
<div class="paragraph">
<p>Additionally, I want to mention the problem of measuring accuracy of recognition. Having found nothing on Google in the first five minutes of the search, I’ve coded my own metric, which turned out to be not that good. That forced me to google some more, and so I’ve found a paper that discusses and compares different metrics (on their own dataset, which is quite different from mine: Arabic handwriting isn’t exactly English words in print). It gave me the names of the metrics however, which was good enough. The paper can be found here: <a href="http://www.ijcsi.org/papers/IJCSI-11-3-1-18-26.pdf" class="bare">http://www.ijcsi.org/papers/IJCSI-11-3-1-18-26.pdf</a> .</p>
</div>
<div class="paragraph">
<p>I’ve settled on Jaro-Winkler distance, which gives sufficiently accurate results. Also it’s implemented in jellyfish package, so it’s quite easy to use.<br>
I hope this article will prove itself useful.<br>
For reference, my final code can be found here: <a href="https://github.com/AwesomeLemon/document-recognition" class="bare">https://github.com/AwesomeLemon/document-recognition</a></p>
</div>
</div>
                        <aside class="tags fi-pricetag-multiple">Posted on <a href="https://AwesomeLemon.github.io/tag/opencv/">opencv</a>, <a href="https://AwesomeLemon.github.io/tag/python/"> python</a>, <a href="https://AwesomeLemon.github.io/tag/tesseract/"> tesseract</a>, <a href="https://AwesomeLemon.github.io/tag/ocr/"> ocr</a>, <a href="https://AwesomeLemon.github.io/tag/open-source/"> open source</a></aside>
            </section>
            <hr>
            <footer class="post-footer">

                <section class="share">
                    <h4>Liked this post ? Share it.</h4>
                    <a class="fi-social-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https://AwesomeLemon.github.io/2017/01/15/Document-recognition-with-Python-OpenCV-and-Tesseract.html"
                        onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
                    </a>
                    <a class="fi-social-twitter" href="https://twitter.com/share?text=Document%20recognition%20with%20Python%2C%20OpenCV%20and%20Tesseract&amp;url=https://AwesomeLemon.github.io/2017/01/15/Document-recognition-with-Python-OpenCV-and-Tesseract.html"
                        onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
                    </a>
                    <a class="fi-social-google-plus" href="https://plus.google.com/share?url=https://AwesomeLemon.github.io/2017/01/15/Document-recognition-with-Python-OpenCV-and-Tesseract.html"
                       onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
                    </a>
                </section>

                <section class="author">
                    <header>
                        <span>About the author</span>
                    </header>
                    <section>
                        <h4>Alexander Chebykin</h4>
                        <img src="https://avatars.githubusercontent.com/u/8983709?v&#x3D;3">
                        <span>Saint-Petersburg</span>
                        
                    </section>
                    <footer>
                         <p></p>
                    </footer>
                </section>

        <div class="clearfix"></div>
                    <hr>

            </footer>

        <h3 class="title-disqus"><span class="fi-comments"></span>Discussions</h3>




        <section class="post-comments">
          <div id="disqus_thread"></div>
          <script type="text/javascript">
          var disqus_shortname = 'awesomelemon-github-io.disqus.com'; // required: replace example with your forum shortname
          /* * * DON'T EDIT BELOW THIS LINE * * */
          (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
          })();
          </script>
          <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
          <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
        </section>


    </article>

</main>

</div>

</div>

    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js?v="></script> <script src="//cdnjs.cloudflare.com/ajax/libs/moment.js/2.9.0/moment-with-locales.min.js?v="></script> <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/highlight.min.js?v="></script> 
      <script type="text/javascript">
        jQuery( document ).ready(function() {
          // change date with ago
          jQuery('ago.ago').each(function(){
            var element = jQuery(this).parent();
            element.html( moment(element.text()).fromNow());
          });
        });

        hljs.initHighlightingOnLoad();
      </script>

    <!--[if lte IE 8]>
        <script type="text/javascript" src="//AwesomeLemon.github.io/themes/ichi/assets/js/outdatedBrowser.min.js?v=1484479362993"></script>
    <![endif]-->
    <script type="text/javascript" src="//AwesomeLemon.github.io/themes/ichi/assets/js/min/built.js?v=1484479362993"></script>

    <script>
      $(document).foundation();
    </script>

</body>
</html>
